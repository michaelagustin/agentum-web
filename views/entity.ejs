<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><%= displayName %> on Agentum</title>

  <!-- Open Graph -->
  <meta property="og:title" content="<%= displayName %> on Agentum" />
  <meta property="og:description" content="<%= [entity.title, entity.organization_name, entity.location].filter(Boolean).join(' · ') || 'View profile on Agentum' %>" />
  <% if (avatarSrc) { %>
  <meta property="og:image" content="<%= avatarSrc %>" />
  <% } %>
  <meta property="og:url" content="<%= canonicalUrl %>" />
  <meta property="og:type" content="profile" />
  <meta property="og:site_name" content="Agentum" />

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="<%= displayName %> on Agentum" />
  <meta name="twitter:description" content="<%= [entity.title, entity.organization_name, entity.location].filter(Boolean).join(' · ') || 'View profile on Agentum' %>" />
  <% if (avatarSrc) { %>
  <meta name="twitter:image" content="<%= avatarSrc %>" />
  <% } %>

  <!-- Smart App Banner -->
  <meta name="apple-itunes-app" content="app-argument=<%= deepLink %>">

  <link rel="canonical" href="<%= canonicalUrl %>" />
  <link rel="stylesheet" href="/css/style.css" />
</head>
<body>
  <div class="container">
    <div class="card">
      <div class="logo">
        <svg width="32" height="32" viewBox="0 0 32 32" fill="none">
          <circle cx="16" cy="16" r="16" fill="#7C3AED"/>
          <text x="16" y="21" text-anchor="middle" fill="white" font-size="16" font-weight="bold" font-family="system-ui">A</text>
        </svg>
        <span class="logo-text">Agentum</span>
      </div>

      <div class="profile">
        <% if (avatarSrc) { %>
        <img class="avatar" src="<%= avatarSrc %>" alt="<%= displayName %>" />
        <% } else { %>
        <div class="avatar avatar-placeholder">
          <%= displayName.charAt(0).toUpperCase() %>
        </div>
        <% } %>

        <h1 class="name"><%= displayName %></h1>

        <% if (entity.username) { %>
        <p class="username">@<%= entity.username %></p>
        <% } %>

        <% if (entity.title || entity.organization_name) { %>
        <p class="subtitle">
          <%= [entity.title, entity.organization_name].filter(Boolean).join(' at ') %>
        </p>
        <% } %>

        <% if (entity.location) { %>
        <p class="location">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/></svg>
          <%= entity.location %>
        </p>
        <% } %>
      </div>

      <button class="cta-button" onclick="openInApp()">Open in Agentum</button>

      <a class="testflight-button" href="<%= testflightUrl %>">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
        Get Agentum on TestFlight
      </a>

      <p class="footer-text">
        Don't have the app yet? Install via <a href="<%= testflightUrl %>">TestFlight</a> and tap this link again.
      </p>
    </div>
  </div>

  <script>
    function openInApp() {
      // Try to open the app via custom scheme
      window.location = '<%= deepLink %>';
      // If the app isn't installed, the scheme redirect silently fails.
      // After a short delay, redirect to TestFlight.
      setTimeout(function() {
        // If we're still on this page, the app didn't open — send to TestFlight
        window.location = '<%= testflightUrl %>';
      }, 1500);
    }
  </script>
</body>
</html>
